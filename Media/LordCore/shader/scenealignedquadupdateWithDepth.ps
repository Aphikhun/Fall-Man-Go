#version 100

precision mediump float;

uniform sampler2D texSampler;
uniform sampler2D depthSampler;
uniform sampler2D currDepthSampler;

varying mediump vec2 texCoord;

void main(void)
{
	float depth = texture2D(depthSampler, texCoord).r;
	float currDepth = texture2D(currDepthSampler, texCoord).r;
	float blendFactor = step(depth, currDepth);

	gl_FragColor = texture2D(texSampler, texCoord);
	gl_FragColor.a *= blendFactor;

	//gl_FragDepth = depth * blendFactor + currDepth * (1.0 - blendFactor);
}