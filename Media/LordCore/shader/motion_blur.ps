#version 100

uniform sampler2D ScnSamp;
uniform mediump float Strength;
uniform mediump vec3 camPosOld;
uniform mediump vec3 camPosNew;
//uniform mediump mat4 matWVP;

varying mediump vec2 texCoord;


void main(void)
{
	
    mediump vec4 color = texture2D( ScnSamp, texCoord );

    color *= 0.75;
    mediump vec2 texCoord2 = texCoord;

   // mediump vec4 PrevClipSpacePos  = matWVP * vec4(camPosOld, 1.0);
   // mediump vec4 ClipSpacePos  = matWVP * vec4(camPosNew, 1.0);

    //mediump vec3 PrevNDCPos = (PrevClipSpacePos / PrevClipSpacePos.w).xyz;
    //mediump vec3 NDCPos = (ClipSpacePos / ClipSpacePos.w).xyz;

    mediump vec2 MotionVector;//  = (NDCPos - PrevNDCPos).xy * 0.00001;
    MotionVector = (camPosNew - camPosOld).xy * 0.2;

    texCoord2 -= MotionVector;
    color += texture2D( ScnSamp, texCoord2) * 0.18;

    texCoord2 -= MotionVector;
    color += texture2D( ScnSamp, texCoord2) * 0.05;

    texCoord2 -= MotionVector;
    color += texture2D( ScnSamp, texCoord2) * 0.02;
 
    gl_FragColor = color * Strength;
}